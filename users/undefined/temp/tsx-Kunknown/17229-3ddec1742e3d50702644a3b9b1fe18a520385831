{"code":"(()=>{\n\"use strict\";var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __copyProps=(to,from,except,desc)=>{if(from&&typeof from===\"object\"||typeof from===\"function\"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,\"default\",{value:mod,enumerable:true}):target,mod));var import_client_dynamodb=require(\"@aws-sdk/client-dynamodb\");var import_zod=require(\"zod\");var import_lib_dynamodb=require(\"@aws-sdk/lib-dynamodb\");var import_express=__toESM(require(\"express\"));var import_serverless_http=__toESM(require(\"serverless-http\"));const app=(0,import_express.default)();const USERS_TABLE=process.env.USERS_TABLE;const client=new import_client_dynamodb.DynamoDBClient;const docClient=import_lib_dynamodb.DynamoDBDocumentClient.from(client);app.use(import_express.default.json());app.get(\"/hello/:userId\",async(req,res)=>{const{userId}=req.body;console.log(\"userId: \",userId);const result=import_zod.z.string().pipe(import_zod.z.coerce.number()).safeParse(userId);if(!result.success){console.log(\"result\",result);res.status(400).json(result.error.issues)}else{res.status(200).json(`hello world! ${result.data}`)}});app.get(\"/users/:userId\",async(req,res)=>{const{userId}=req.params;const params={TableName:USERS_TABLE,Key:{userId}};try{const command=new import_lib_dynamodb.GetCommand(params);const response=await docClient.send(command);const Item=response.Item;if(Item){res.json(Item)}else{res.status(404).json({error:`Could not find ther user with userId: ${userId}`})}}catch(error){console.log(error);res.status(500).json({error:\"Could not retrieve user\"})}});app.post(\"/users\",async(req,res)=>{const User=import_zod.z.object({userId:import_zod.z.coerce.number(),firstName:import_zod.z.string(),lastName:import_zod.z.string(),email:import_zod.z.string().min(6).email(),dob:import_zod.z.string().date(),createdAt:import_zod.z.string().datetime(),updatedAt:import_zod.z.string().datetime()});const item=req.body;const{userId,firstName,lastName,email,dob}=item;if(typeof userId!==\"string\"){res.status(400).json({error:'\"userId\" must be a string'})}else if(typeof name!==\"string\"){res.status(400).json({error:'\"name\" must be a string'})}const params={TableName:USERS_TABLE,Item:item};try{const command=new import_lib_dynamodb.PutCommand(params);await docClient.send(command);res.json({userId,name})}catch(error){console.error(error);res.status(500).json({error:\"Could not create user\"})}});app.put(\"/users/:userId\",async(req,res)=>{res.status(200).json(\"users PUT\")});app.delete(\"/users/:userId\",async(req,res)=>{res.status(200).json(\"users DELETE\")});app.use((req,res)=>{return res.status(404).json({error:\"Page Not Found\"})});exports.handler=(0,import_serverless_http.default)(app);\n})()\n","warnings":[],"map":{"version":3,"mappings":"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","names":["express","serverless"],"ignoreList":[],"sources":["F:\\2024 Projects\\serverless-user-service\\users\\handler.ts"],"sourcesContent":[null]}}